/*! (c) Philipp KÃ¶nig under GPL-3.0 */

"use strict";!function(){window.ext=function(e){this.run=function(){n(),o()};var n=function(){var n=["pxTolerance","showIndicator","closeTab"];chrome.storage.sync.get(n,function(i){n.forEach(function(n){void 0!==i[n]&&(e.config[n]=i[n])}),t(),s()})},i=function(){var n=0!==window.screenX||0!==window.screenY||window.screen.availWidth!==window.innerWidth;return e.config.pxTolerance[n?"windowed":"maximized"]},o=function(){document.addEventListener("mousedown",function(n){var o=i(),t=document.querySelector("#"+e.ids.indicator);if(t.classList.contains(e.classes.visible)&&t.classList.contains(e.classes.hover)&&o<e.config.indicatorWidth&&(o=e.config.indicatorWidth),n.pageX<o&&0===n.button){var s=!0;window.onbeforeunload=window.onpopstate=function(){s=!1},window.history.back(),setTimeout(function(){e.config.closeTab&&s&&chrome.extension.sendMessage({type:"closeTab"})},200)}},{passive:!0}),document.addEventListener("DOMContentLoaded",function(){t()})},t=function(){if(document&&document.body&&null===document.querySelector("#"+e.ids.indicator)){var n=document.createElement("div");n.id=e.ids.indicator,document.body.appendChild(n),n.style.width=i()+"px",e.config.showIndicator&&(n.classList.add(e.classes.visible),document.addEventListener("mousemove",function(o){o.pageX<i()?n.classList.add(e.classes.hover):(void 0===o.pageX||o.pageX>e.config.indicatorWidth)&&n.classList.remove(e.classes.hover)},{passive:!0}),document.addEventListener("visibilitychange",function(){document.hidden&&n.classList.remove(e.classes.hover)}),window.addEventListener("resize",function(){n.style.width=i()+"px"},{passive:!0}))}},s=function(){document.dispatchEvent(new CustomEvent(e.events.loaded,{detail:{pxTolerance:i(),showIndicator:e.config.showIndicator},bubbles:!0,cancelable:!1}))}}}(),function(){var e={ids:{indicator:"blockbyte-lsb-indicator"},classes:{visible:"blockbyte-lsb-visible",hover:"blockbyte-lsb-hover"},events:{loaded:"blockbyte-lsb-loaded"},config:{pxTolerance:{windowed:20,maximized:1},showIndicator:!0,closeTab:!1,indicatorWidth:40}};new window.ext(e).run()}();