/*! (c) Philipp KÃ¶nig under GPL-3.0 */

"use strict";!function(){window.ext=function(e){this.run=function(){n()};var n=function(){var n=["pxTolerance","showIndicator","closeTab","openAction"];chrome.storage.sync.get(n,function(o){console.log(o),n.forEach(function(n){void 0!==o[n]&&(e.config[n]=o[n])}),i(),t(),c()})},o=function(){var n=0!==window.screenX||0!==window.screenY||window.screen.availWidth!==window.innerWidth;return e.config.pxTolerance[n?"windowed":"maximized"]},i=function(){document.addEventListener(e.config.openAction,function(n){if(n.isTrusted){var i=o(),t=document.querySelector("#"+e.ids.indicator);if(t.classList.contains(e.classes.visible)&&t.classList.contains(e.classes.hover)&&i<e.config.indicatorWidth&&(i=e.config.indicatorWidth),n.pageX<i&&("mousedown"!==e.config.openAction||0===n.button)){n.stopPropagation(),n.preventDefault();var c=!0;window.onbeforeunload=window.onpopstate=function(){c=!1},window.history.back(),setTimeout(function(){e.config.closeTab&&c&&chrome.extension.sendMessage({type:"closeTab"})},200)}}}),document.addEventListener("DOMContentLoaded",function(){t()})},t=function(){if(document&&document.body&&null===document.querySelector("#"+e.ids.indicator)){var n=document.createElement("div");n.id=e.ids.indicator,document.body.appendChild(n),n.style.width=o()+"px",e.config.showIndicator&&(n.classList.add(e.classes.visible),document.addEventListener("mousemove",function(i){i.pageX<o()?n.classList.add(e.classes.hover):(void 0===i.pageX||i.pageX>e.config.indicatorWidth)&&n.classList.remove(e.classes.hover)},{passive:!0}),document.addEventListener("visibilitychange",function(){document.hidden&&n.classList.remove(e.classes.hover)}),window.addEventListener("resize",function(){n.style.width=o()+"px"},{passive:!0}))}},c=function(){document.dispatchEvent(new CustomEvent(e.events.loaded,{detail:{pxTolerance:o(),showIndicator:e.config.showIndicator},bubbles:!0,cancelable:!1}))}}}(),function(){var e={ids:{indicator:"blockbyte-lsb-indicator"},classes:{visible:"blockbyte-lsb-visible",hover:"blockbyte-lsb-hover"},events:{loaded:"blockbyte-lsb-loaded"},config:{pxTolerance:{windowed:20,maximized:1},openAction:"mousedown",showIndicator:!0,closeTab:!1,indicatorWidth:40}};new window.ext(e).run()}();