/*! (c) Philipp KÃ¶nig under GPL-3.0 */
(()=>{"use strict";window.ext=function(e){let o=!1;this.run=(()=>{i()});let i=()=>{let o=["pxTolerance","showIndicator","closeTab","openAction"];chrome.storage.sync.get(o,i=>{o.forEach(o=>{void 0!==i[o]&&(e.config[o]=i[o])}),t(),s(),c()})},n=()=>{let o=0!==window.screenX||0!==window.screenY||window.screen.availWidth!==window.innerWidth;return+e.config.pxTolerance[o?"windowed":"maximized"]},t=()=>{document.addEventListener(e.config.openAction,o=>{if(o.isTrusted&&("mousedown"!==e.config.openAction||0===o.button)&&d(o.pageX,o.pageY)){o.stopPropagation(),o.preventDefault();let i=!0;window.onbeforeunload=window.onpopstate=(()=>{i=!1}),window.history.back(),setTimeout(()=>{e.config.closeTab&&i&&chrome.extension.sendMessage({type:"closeTab"})},200)}}),document.addEventListener("DOMContentLoaded",()=>{s()})},s=()=>{if(document&&document.body&&null===document.querySelector("#"+e.ids.indicator)){let o=document.createElement("div");o.id=e.ids.indicator,document.body.appendChild(o),o.style.width=n()+"px",e.config.showIndicator&&(o.classList.add(e.classes.visible),document.addEventListener("mousemove",i=>{i.isTrusted&&d(i.pageX,i.pageY)?o.classList.add(e.classes.hover):(void 0===i.pageX||i.pageX>=e.config.indicatorWidth)&&o.classList.remove(e.classes.hover)}),document.addEventListener("visibilitychange",()=>{document.hidden&&o.classList.remove(e.classes.hover)}),window.addEventListener("resize",()=>{o.style.width=n()+"px"},{passive:!0}))}},d=(i,t)=>{let s=!1;if(void 0!==i&&null!==i&&(i>0||t>0||o)){o=!0;let t=document.querySelector("#"+e.ids.indicator);if(t){let o=n();t.classList.contains(e.classes.visible)&&t.classList.contains(e.classes.hover)&&e.config.indicatorWidth>o&&(o=e.config.indicatorWidth),s=i<o}}return s},c=()=>{document.dispatchEvent(new CustomEvent(e.events.loaded,{detail:{pxTolerance:n(),showIndicator:e.config.showIndicator},bubbles:!0,cancelable:!1}))}}})(),(()=>{"use strict";let e={ids:{indicator:"blockbyte-lsb-indicator"},classes:{visible:"blockbyte-lsb-visible",hover:"blockbyte-lsb-hover"},events:{loaded:"blockbyte-lsb-loaded"},config:{pxTolerance:{windowed:20,maximized:1},openAction:"mousedown",showIndicator:!0,closeTab:!1,indicatorWidth:40}};new window.ext(e).run()})();